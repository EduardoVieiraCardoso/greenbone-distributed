# ===========================================
# Scan Hub Configuration
# ===========================================

# GVM probes — one or more Greenbone instances
# Scans are distributed across probes (least-busy selection)
probes:
  - name: "gvm-1"
    host: "192.168.15.20"
    port: 9390
    username: "admin"
    password: "admin"
    timeout: 300
    retry_attempts: 3
    retry_delay: 5
#  - name: "gvm-2"
#    host: "192.168.15.30"
#    port: 9390
#    username: "admin"
#    password: "admin"

# Legacy single-probe format (still supported):
# gvm:
#   host: "127.0.0.1"
#   port: 9390
#   username: "admin"
#   password: "admin"

# Adapter API (this service)
api:
  host: "0.0.0.0"
  port: 8080
  jwt_secret: ""               # Set a secret to enable JWT auth (empty = auth disabled)
  jwt_expire_minutes: 1440     # Token expiration in minutes (default: 24h)

# Scan settings
scan:
  poll_interval: 30      # seconds between GVM status checks
  max_duration: 86400    # max scan duration in seconds (default: 24h)
  cleanup_after_report: true  # delete GVM resources (target/task) after report collected
  default_port_list: "All IANA assigned TCP"  # GVM port list for full scans
  gvm_scan_config: "Full and fast"           # GVM scan config name
  gvm_scanner: "OpenVAS Default"             # GVM scanner name
  alive_test: "ICMP & TCP-ACK Service Ping"  # Host discovery method
  db_path: "scans.db"                        # SQLite database path
  scheduler_interval: 60                     # seconds between scheduler checks

# External target source (optional — enables auto-sync and scheduled scans)
# source:
#   url: "https://cmdb.empresa.com/api/v1/targets"
#   auth_token: "Bearer eyJhbGciOiJIUzI1NiIs..."
#   sync_interval: 300        # seconds between syncs (default: 5min)
#   callback_url: ""           # POST results back (optional)
#   timeout: 30                # HTTP timeout
#   scheduler_interval: 60     # seconds between scheduler checks

# Logging
logging:
  level: "INFO"          # DEBUG, INFO, WARNING, ERROR
  format: "console"      # console or json
